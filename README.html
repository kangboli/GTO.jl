<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="gto">GTO</h1>
<p>This package aims to provide <em>flexible</em> abstractions for the
Gaussian integrals temporarily at the expensive of performance. The
targeted audience is method developers including myself, for whom
performance is often a secondary concern compared to flexibility.</p>
<p>The API of this package provides what a package user naively would
want as oppose to what gives the optimal performance. For example, we
provide the API for computing the integrals one at a time instead of
having to evaluate in bulk. However, this does not necessarily mean
sacrificing performance. Instead, one should think about this as
abstracting away performance considerations from the users. For example,
we could build a cache for the integrals, and bulk evaluation is an
implementation detail for improving cache locality. This way, we could
obtain similar performance without limiting the API to a few
counterintuitive fast operations.</p>
<p>The theory implemented is <a
href="https://doi.org/10.1016/0021-9991(78)90092-X">McMurchie &amp;
Davidson 1978</a> and <a
href="https://royalsocietypublishing.org/doi/10.1098/rspa.1950.0036">Boys
1949</a></p>
<h2 id="usage">Usage</h2>
<h3 id="load-a-basis-set">Load a basis set</h3>
<p>The basis set is downloaded from <a
href="https://www.basissetexchange.org/">BSE</a>. Only
<code>.json</code> files are supported at the moment.</p>
<p>To load a basis set, pass in the filename, which can be found in
<code>basis_set_bundle-json-bib</code>.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode julia"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fu">load_basis</span>(<span class="st">&quot;sto-3g.1.json&quot;</span>)</span></code></pre></div>
<h3 id="atoms-and-aos">Atoms and AOs</h3>
<p>To create the atom, pass in the atomic number and the coordinates.
The unit is currently in Bohr by default, but I don’t know if that is
standard. It seems that <code>pyscf</code> uses Angstrom, which can be
converted through <code>BOHR_TO_ANGSTROM</code>.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode julia"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>a_1 <span class="op">=</span> <span class="fu">Atom</span>(<span class="fl">6</span>, [<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>])</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>a_2 <span class="op">=</span> <span class="fu">Atom</span>(<span class="fl">6</span>, [<span class="fl">2</span> <span class="op">/</span> BOHR_TO_ANGSTROM, <span class="fl">0</span>, <span class="fl">0</span>])</span></code></pre></div>
<p>To create AOs for the atom, load them from the basis set
<code>b</code>. The result is <code>shells</code> of contracted
Gaussians. The basis can then be constructed from the shells.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode julia"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>shells <span class="op">=</span> <span class="fu">make_gaussians</span>(b, a_1, a_2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>basis <span class="op">=</span> <span class="fu">vcat</span>(<span class="fu">get_basis</span>.(shells)<span class="op">...</span>)</span></code></pre></div>
<h3 id="gaussians">Gaussians</h3>
<h4 id="cartesian-gaussian">Cartesian Gaussian</h4>
<p>One typically does not need to construct this by hand, but it is good
to know what they are. A Cartesian Gaussian with angular momentum
<code>i,j,k</code>, exponent <code>α</code>, and center <code>c</code>
can be constructed as</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode julia"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fu">CartesianGaussian</span>(<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, [<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>])</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                     i  j  k  α,  c</span></span></code></pre></div>
<h4 id="hermite-gaussian">Hermite Gaussian</h4>
<p>The Hermite Gaussians can be constructed similarly to the Cartesian
Gaussians. They are not used in GTO theories to represent the basis, but
to represent products of Cartesian Gaussians.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode julia"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> <span class="fu">HermiteGaussian</span>(<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, [<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>])</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                   i  j  k  α,  c</span></span></code></pre></div>
<h4 id="spherical-gaussians">Spherical Gaussians</h4>
<p>Not yet implemented. Don’t need it for the moment.</p>
<h4 id="contracted-gaussians">Contracted Gaussians</h4>
<p>These are just sums of Gaussians. Sums of Cartesian Gaussians are
used to represent contracted basis, whereas contracted Hermite Gaussians
are used to represent products of (possibly contracted) Cartesian
Gaussians.</p>
<p>TODO: Come up with an API.</p>
<h4 id="the-product-of-two-gaussians">The Product of two Gaussians</h4>
<p>To multiply two (contracted) Cartesian Gaussians <code>p</code> and
<code>q</code> together, use</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode julia"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gaussian_product</span>(p, q)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">*</span> q   <span class="co"># Syntax sugar.</span></span></code></pre></div>
<p>The result will be a contracted Hermite Gaussian. There is current no
support (or need) for multiplying Hermite Gaussians.</p>
<h3 id="integrals">Integrals</h3>
<p>The integrals necessary for HF and possibly mildly beyond are
implemented.</p>
<h4 id="overlap">Overlap</h4>
<p>The overlap integrals are performed as</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode julia"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">overlap_integral</span>(p, q)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>p<span class="op">&#39;</span> <span class="op">*</span> q    <span class="co"># Syntax sugar.</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> [p<span class="op">&#39;</span> <span class="op">*</span> q for p <span class="kw">in</span> basis, q <span class="kw">in</span> basis] <span class="co"># The overlap matrix.</span></span></code></pre></div>
<h4 id="kinetic">Kinetic</h4>
<p>The kinetic integrals are performed as</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode julia"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kinetic_integral</span>(p, q)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>p<span class="op">&#39;</span> <span class="op">*</span> ∇² <span class="op">*</span> q     <span class="co"># Syntax sugar.</span></span></code></pre></div>
<h4 id="nuclear">Nuclear</h4>
<p>The nuclear integral for a few <code>Atom</code>s can be written
as</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode julia"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nuclear_potential</span>(p <span class="op">*</span> q, a_1) <span class="op">+</span> <span class="fu">nuclear_potential</span>(p <span class="op">*</span> q, a_2)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>p<span class="op">&#39;</span> <span class="op">*</span> <span class="fu">VNuc</span>(a_1, a_2) <span class="op">*</span> q     <span class="co"># Syntax sugar.</span></span></code></pre></div>
<h4 id="two-electrons">Two electrons</h4>
<p>Two electron integrals are performed as</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode julia"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">two_electron_integral</span>(p<span class="op">*</span>q, r<span class="op">*</span>s)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>(p<span class="op">*</span>q <span class="op">|</span> r<span class="op">*</span>s)   <span class="co"># Syntax sugar.</span></span></code></pre></div>
</body>
</html>
